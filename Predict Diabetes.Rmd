---
title: <center>Predict Diabetes </center> 
author:  <center>Huynh | Ravindra | Sood | Swamykannu </center>
output:
  html_document:
  code_folding: show
  highlight: monochrome
  theme: flatly
  pdf_document: default
  word_document: default
---

# {.tabset .tabset-fade .tabset-pills}

## Synopsis 
The data was collected and made available by "National Institute of Diabetes and Digestive and Kidney Diseases. Our project focuses on factors which affect the likelihood of person getting the diabetes.
![image](https://3n9hl3wy2ektx6nh3y3tpu15-wpengine.netdna-ssl.com/wp-content/uploads/sites/22/2019/01/diabetestest_647161.jpg)

## Packages Required
```{r List of packages used for the project}
library(readxl)
library(kableExtra)
library(corrplot)
library(dplyr)
library(ggplot2)
library(GGally)
library(tidyr)
library(DT)
packages <- read_excel("C:/Users/Radhika Sood/Documents/DAM_project/Packages.xlsx")
kable(packages)%>%
kable_styling( bootstrap_options = c("striped", "responsive"))

```

## Data Preparation

### Data Source

The link to original dataset can be found [here](https://www.kaggle.com/kandij/diabetes-dataset)
This dataset contains 768 rows.
```{r Importing data from URL into the table} 
data <- read.csv("C:/Users/Radhika Sood/Desktop/R datasets/diabetes-dataset/diabetes2.csv", stringsAsFactors = FALSE, header = TRUE)
head(data)
```
Some important variables which we will use for analysis are:
names(data)

###Data Cleaning 

```{r Check for missing values}
    any(is.na(data))
    any(is.null(data))
    
```
```{r Check for duplicate values}
duplicate_value <- data[duplicated(data),]
head(unique(data))

sapply(data, function(x) length(unique(x)))
```
Using duplicate function, we can find the duplicate values in the row. It returns FALSE for each row indicating no duplicates. We verified it by using the Unique() function, the unique function returns the nuique rows in the dataset. We get 768 rows. Thus, we have no duplicate values in the data.
 
 
All living organisms dont have zero blood pressure. We need to replace the rows with zero blood pressure with the mean values of the blood pressure.  
```{r Check for incorrect values and replace with relevant values}
# People with no diabetes an zero blood pressure values
non_diabetic <- which(data$BloodPressure==0 & data$Outcome==0)
temp_mean <- mean(data$BloodPressure[!data$BloodPressure==0 & data$Outcome==0])
data$BloodPressure[non_diabetic] <- temp_mean

# People with diabetes an zero blood pressure values
diabetic <- which(data$BloodPressure==0 & data$Outcome==1)
data$BloodPressure[diabetic] <- mean(data$BloodPressure[!data$BloodPressure==0 & data$Outcome==1])

# People with no diabetes an zero Glucose values
non_diabetic <- which(data$Glucose==0 & data$Outcome==0)
data$Glucose[non_diabetic] <- mean(data$Glucose[!data$Glucose==0 & data$Outcome==0])

# People with diabetes an zero Glucose values
diabetic <- which(data$Glucose==0 & data$Outcome==1)
data$Glucose[diabetic] <- mean(data$Glucose[!data$Glucose==0 & data$Outcome==1])

# People with no diabetes an zero Skin Thickness values
non_diabetic <- which(data$SkinThickness==0 & data$Outcome==0)
data$SkinThickness[non_diabetic] <- mean(data$SkinThickness[!data$SkinThickness==0 & data$Outcome==0])

# People with diabetes an zero Skin Thickness values
diabetic <- which(data$SkinThickness==0 & data$Outcome==1)
data$SkinThickness[diabetic] <- mean(data$SkinThickness[!data$SkinThickness==0 & data$Outcome==1])

# People with no diabetes an zero Insulin values
non_diabetic <- which(data$Insulin==0 & data$Outcome==0)
data$Insulin[non_diabetic] <- mean(data$Insulin[!data$Insulin==0 & data$Outcome==0])

# People with diabetes an zero Insulin values
diabetic <- which(data$Insulin==0 & data$Outcome==1)
data$Insulin[diabetic] <- mean(data$Insulin[!data$Insulin==0 & data$Outcome==1])

# People with no diabetes an zero BMI values
non_diabetic <- which(data$BMI==0 & data$Outcome==0)
data$BMI[non_diabetic] <- mean(data$BMI[!data$BMI==0 & data$Outcome==0])

# People with diabetes an zero BMI values
diabetic <- which(data$BMI==0 & data$Outcome==1)
data$BMI[diabetic] <- mean(data$BMI[!data$BMI==0 & data$Outcome==1])

summary(data)
```
### Variable details 
  
## Exploratory Data Analysis
### Check correlation between the variables 
```{r}

pairs(data)
corrplot(cor(data[,-10]),type = "lower", method="number")
ggplot(gather(data[,-9]),aes(value)) + geom_histogram() + facet_wrap(key~.,scales="free_x")
```
We can see the range of values for each variable, where most of the values are scattered.

Claire- Can you add findings from the above graph? write shor description about each variable. Left skewed? Normal distribution ?values are in this range etc.?

Claire - Describe: High correlation between which varibales?

As we can see, from the corrplot, there is significant correlation between the Outcome and Glucose, Insulin.


Scatterplot and Boxplot between the variables

```{r}

ggplot(data, aes(x= as.factor(Insulin), y= BMI)) + geom_boxplot() + ylab("Pregnancies") + facet_grid("as.factor(Outcome)~.")
ggplot(data, aes(y= Insulin)) + geom_boxplot() + xlab("Insulin")
ggplot(data, aes(y= Glucose)) + geom_boxplot() + xlab("Glucose")
ggplot(data, aes(y= Glucose)) + geom_boxplot() + xlab("Age")

```

plot(data$outcome,data$pregnancies)

## Model
Preparing the Test and Train data
```{r}
set.seed(123)
n <- nrow(data)
train <- sample(n, trunc(0.70*n))
training_data <- data[train, ]
testing_data<- data[-train, ]
```


Creating the Model usong Logistic Regression
Model uing all the covariates
```{r}
estimated_model <- glm(Outcome~.,training_data,family="binomial")
summary(estimated_model)
```
```{r}
estimated_model <- update(estimated_model, ~. - SkinThickness - BloodPressure - Age - DiabetesPedigreeFunction)
summary(estimated_model)
```

Claire- discuss p-value and tell why Pregnancies, Glucose, Blood Pressure, Insulin, BMI are highly significant covariates.



## Residual Analysis

## Model Validation

## Model Accuracy
